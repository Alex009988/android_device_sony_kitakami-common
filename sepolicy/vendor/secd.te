type secd, domain;
type secd_exec, exec_type, file_type;

# Started by init
init_daemon_domain(secd)

allow secd diag_data_file:dir search;
allow secd diag_data_file:sock_file write;
allow secd diag_partition_device:dir search;
allow secd firmware_file:dir search;
allow secd firmware_file:file { getattr open read r_file_perms };
allow secd iddd:unix_dgram_socket sendto;
allow secd ion_device:chr_file { ioctl open read r_file_perms };
allow secd secd_data_file:dir { add_name search open read write remove_name };
allow secd secd_data_file:dir { rw_file_perms add_name remove_name search };
allow secd secd_data_file:file { rw_file_perms ioctl };
allow secd secd_data_file:file { lock open write create getattr read setattr unlink };
allow secd socket_device:sock_file write;
allow secd system_data_file:file rw_file_perms;
allow secd tad:unix_stream_socket connectto;
allow secd tad_socket:sock_file write;
allow secd tee_device:chr_file { ioctl open read write rw_file_perms };

# Allow secd to access tad
unix_socket_connect(secd, tad, tad)

# Allow secd to set secd_prop
set_prop(secd, secd_prop)
